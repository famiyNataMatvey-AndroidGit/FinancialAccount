package com.namutomatvey.financialaccount.activity;import android.content.Intent;import android.database.Cursor;import android.database.sqlite.SQLiteDatabase;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.Menu;import android.view.MenuItem;import android.view.View;import android.widget.AdapterView;import android.widget.Button;import android.widget.EditText;import android.widget.GridView;import android.widget.TextView;import android.widget.Toast;import com.namutomatvey.financialaccount.DBHelper;import com.namutomatvey.financialaccount.R;import com.namutomatvey.financialaccount.SPHelper;import com.namutomatvey.financialaccount.adapter.CurrencyAdapter;import com.namutomatvey.financialaccount.dto.Currency;import com.namutomatvey.financialaccount.dto.Finance;import java.util.ArrayList;import java.util.List;public class SettingDetailActivity extends AppCompatActivity {    private static final int RESULT_ACTIVITY_DEFAULT_CURRENCY = 1;    private static final int RESULT_ACTIVITY_PROBLEM = 2;    private static final int RESULT_ACTIVITY_ABOUT_DEVELOPER = 3;    private Toolbar mActionBarToolbar;    private int selected_button;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_setting_detail);        mActionBarToolbar = findViewById(R.id.toolbar);        String title = getIntent().getExtras().getString("title", getResources().getString(R.string.title_activity_settings));        mActionBarToolbar.setTitle(title);        setSupportActionBar(mActionBarToolbar);        selected_button = getIntent().getIntExtra("selected_button", RESULT_ACTIVITY_ABOUT_DEVELOPER);        final GridView gridViewDefaultCurrency = findViewById(R.id.gridViewDefaultCurrency);        final EditText editTextProblemMessage = findViewById(R.id.editTextProblemMessage);        Button buttonProblemMessage = findViewById(R.id.buttonProblemMessage);        TextView textViewAboutDeveloper = findViewById(R.id.textViewAboutDeveloper);        switch (selected_button) {            case RESULT_ACTIVITY_DEFAULT_CURRENCY:                gridViewDefaultCurrency.setVisibility(View.VISIBLE);                DBHelper dbHelper = new DBHelper(this);                SQLiteDatabase database = dbHelper.getReadableDatabase();                Cursor cursor = database.query(DBHelper.TABLE_CURRENCY, null, null, null, null, null, null);                int idIndex = cursor.getColumnIndex(DBHelper.KEY_ID);                int nameIndex = cursor.getColumnIndex(DBHelper.KEY_NAME);                int shortNameIndex = cursor.getColumnIndex(DBHelper.KEY_SHORT_NAME);                int coefficientIndex = cursor.getColumnIndex(DBHelper.KEY_COEFFICIENT);                List<Currency> currencies = new ArrayList<Currency>();                if (cursor.moveToFirst()) {                    do {                        currencies.add(new Currency(cursor.getLong(idIndex),                                cursor.getString(nameIndex),                                cursor.getString(shortNameIndex),                                cursor.getDouble(coefficientIndex)));                    } while (cursor.moveToNext());                }                gridViewDefaultCurrency.setAdapter(new CurrencyAdapter(this, currencies));                break;            case RESULT_ACTIVITY_PROBLEM:                editTextProblemMessage.setVisibility(View.VISIBLE);                buttonProblemMessage.setVisibility(View.VISIBLE);                break;            case RESULT_ACTIVITY_ABOUT_DEVELOPER:                textViewAboutDeveloper.setVisibility(View.VISIBLE);                break;        }        buttonProblemMessage.setOnClickListener(                new View.OnClickListener() {                    @Override                    public void onClick(View v) {                        Intent i = new Intent(Intent.ACTION_SEND);                        i.setType("message/rfc822");                        i.putExtra(Intent.EXTRA_EMAIL, new String[]{"fami1y.NataMatvey@gmail.com"});                        i.putExtra(Intent.EXTRA_SUBJECT, "Сообщение с пожеланиями. Для разработчиков.");                        i.putExtra(Intent.EXTRA_TEXT, editTextProblemMessage.getText().toString());                        try {                            startActivity(Intent.createChooser(i, "Send mail..."));                        } catch (android.content.ActivityNotFoundException ex) {                            Toast.makeText(SettingDetailActivity.this, "There are no email clients installed.", Toast.LENGTH_SHORT).show();                        }                    }                }        );        gridViewDefaultCurrency.setOnItemClickListener(new AdapterView.OnItemClickListener() {            @Override            public void onItemClick(AdapterView<?> parent, View v, int position, long id) {                Currency currency = (Currency) gridViewDefaultCurrency.getItemAtPosition(position);                long currency_id = currency.getId();                long default_currency_id = SPHelper.getDefaultCurrency();                if (default_currency_id == currency_id)                    finish();                Finance.updateAmountCurrency(new DBHelper(SettingDetailActivity.this), currency_id);                finish();            }        });    }    @Override    public boolean onCreateOptionsMenu(Menu menu) {        getMenuInflater().inflate(R.menu.main_menu, menu);        MenuItem setting_item = menu.findItem(R.id.menu_settings);        setting_item.setVisible(false);        mActionBarToolbar.setNavigationIcon(R.drawable.ic_back);        return true;    }    @Override    public boolean onOptionsItemSelected(MenuItem item) {        this.finish();        return super.onOptionsItemSelected(item);    }}